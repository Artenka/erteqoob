extends ../layouts/main-client.jade

block contents
  div.main-layout#home
    include ../partials/main-nav-cities.jade
    include ../partials/main-nav-socials.jade
    include ../partials/main-nav-toggle.jade
    include ../partials/register-link.jade
    div.scroll-layout
      include ../partials/home/home-intro.jade
      include ../partials/home/home-nav.jade
      include ../partials/home/home-think.jade
      include ../partials/home/home-video.jade
      include ../partials/home/home-about.jade
      include ../partials/home/home-founders.jade
      include ../partials/home/home-system.jade
      include ../partials/home/home-events.jade
      include ../partials/home/home-collections.jade
      include ../partials/home/home-blog.jade
      include ../partials/home/home-action.jade
      include ../partials/footer.jade



  script.
    $(function () {
      fixedMenusInitAnimation();

      // hide fixed menus on mobile
      $(window).on('resize', function () {
        var window = $(this);
        if (window.width() < 640) {
          TweenMax.to($('.main-layout > .main-nav--cities'), 1, {opacity: 0, ease: Power1.easeOut});
          TweenMax.to($('.main-layout > .register-link'), 1, {opacity: 0, ease: Power1.easeOut});
          TweenMax.to($('.main-layout > .main-nav--socials'), 1, {opacity: 0, ease: Power1.easeOut});
        } else {
          if ($('.onepage-pagination li .active').data('index') == 1) {
            TweenMax.to($('.main-layout > .main-nav--cities'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
            TweenMax.to($('.main-layout > .register-link'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
          }
        }
      });

      // init animations on mobile
      if ($(window).width() < 640) {
        homeIntroInit();
        homeNavInit();
        homeThinkInit();
        homeVideoInit();
      }

      // Onepage scroll init
      var pageScroll = ".scroll-layout";
      $(pageScroll).onepage_scroll({
        sectionContainer: "section",
        easing: "ease",
        animationTime: 2000,
        pagination: true,
        updateURL: false,
        beforeMove: function (index) {
          if (index == 12) {
            hideFixedMenus();
          } else {
            showFixedMenus();
          }

          if (index == 1) {
            homeIntroInit();
          } else if (index == 2) {
            homeIntroHide();
            homeNavInit();
          } else if (index == 3) {
            homeIntroHide();
            homeThinkInit();
          } else if (index == 4) {
            homeIntroHide();
            homeVideoInit();
          }
        },
        afterMove: function(index) {

        },
        loop: false,
        keyboard: true,
        responsiveFallback: 640,
        direction: "vertical"
      });

      setTimeout(function () {
        if($('.onepage-pagination li .active').data('index') == 1) {
          homeIntroInit();
        }
      }, 100);


    });

    function showPagePagination() {
      setTimeout(function () {
        TweenMax.to($('.onepage-pagination'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.6});
      }, 100);
    }

    function fixedMenusInitAnimation() {
      if ($(window).width() >= 640) {
        TweenMax.to($('.main-nav--cities'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
        TweenMax.to($('.register-link'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
      }
      TweenMax.to($('.main-nav-toggle'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
    }

    function homeIntroInit(){
      var logoTitle = '.intro-logo__title';
      var logoText = '.intro-logo__text';

      TweenMax.to($('.link-aside'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.3});
      TweenMax.to($('.scroll-down'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
      if ($(window).width() >= 640) {
        TweenMax.to($('.main-layout > .main-nav--socials'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
      }
      setTimeout(function () {
        TweenMax.to($('.onepage-pagination'), 1, {opacity: 0, ease: Power4.easeOut});
      }, 100);

      TweenMax.to($('.intro-bg'), 3, {scaleX: 1.1, scaleY: 1.1, opacity: 1, ease: Power4.easeOut});
      TweenMax.to($('.intro-logo__circle--3'), 0.7, {opacity: 1, ease: Power4.easeOut});
      TweenMax.to($('.intro-logo__circle--2'), 0.7, {opacity: 1, top: '9.5%', left: '9.5%', width: '81%', height: '81%', ease: Power4.easeOut, delay: 0.5});
      TweenMax.to($('.intro-logo__circle--1'), 0.7, {opacity: 1, top: 0, left: 0, width: '100%', height: '100%', ease: Power4.easeOut, delay: 1});
      TweenMax.to($('.intro-logo__img'), 2, {opacity: 1, delay: 0.5, ease: Power4.easeOut});
      TweenMax.to($(logoTitle), 0.7, {opacity: 1, delay: 1, ease: Power1.easeOut});
      TweenMax.to($(logoTitle), 2, {top: 0, delay: 1, ease: Power4.easeOut});
      TweenMax.to($(logoText), 0.7, {opacity: 1, delay: 1.5, ease: Power1.easeOut});
      TweenMax.to($(logoText), 2, {top: 0, delay: 1.5, ease: Power4.easeOut});
      TweenMax.to($('.intro-logo__circle'), 0.7, {opacity: 0, ease: Power1.easeOut, delay: 3});
    }

    function homeIntroHide(){
      TweenMax.to($('.main-layout > .main-nav--socials'), 1, {opacity: 0, ease: Power4.easeOut});
      TweenMax.to($('.link-aside'), 1, {opacity: 0, ease: Power4.easeOut});
      TweenMax.to($('.scroll-down'), 1, {opacity: 0, ease: Power4.easeOut});
      //TweenMax.to($('.main-nav-toggle'), 1, {opacity: 0, ease: Power4.easeOut});
      //setTimeout(function () {
      //  TweenMax.to($('.onepage-pagination'), 1, {opacity: 0, ease: Power4.easeOut});
      //}, 100);
    }

    function homeNavInit(){
      TweenMax.staggerTo( $(".home-nav__item"), 1, { top: '0', ease : Power1.easeInOut }, 0.2 );
      showPagePagination();
      //TweenMax.to($('.main-nav-toggle'), 1, {opacity: 1, ease: Power1.easeOut, delay: 1});
      //setTimeout(function () {
      //  TweenMax.to($('.onepage-pagination'), 1, {opacity: 1, ease: Power1.easeOut, delay: 1});
      //}, 100);
    }

    function homeThinkInit() {
      TweenMax.staggerTo($(".home-think__item-bg"), 0.8, {left: '0', opacity: '1', ease: Power1.easeInOut}, 0.5);
      TweenMax.staggerTo($(".home-think__item-title"), 0.8, {top: '0', opacity: '1', ease: Power1.easeInOut}, 0.5);
      TweenMax.staggerTo($(".home-think__item-text"), 0.8, {top: '0', opacity: '1', ease: Power1.easeInOut}, 0.5);
      showPagePagination();
    }

    function homeVideoInit() {
      TweenMax.to($(".home-video__title"), 1.7, {top: '0', opacity: '1', ease: Power1.easeInOut, delay: 0.3});
      TweenMax.to($(".home-video__btn"), 1.7, {top: '0', opacity: '1', ease: Power1.easeInOut, delay: 0.3});
      TweenMax.to($(".home-video__text"), 1.7, {top: '0', opacity: '1', ease: Power1.easeInOut, delay: 0.3});
      showPagePagination();
    }