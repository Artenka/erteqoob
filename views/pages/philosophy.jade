extends ../layouts/main-client.jade

block contents
  div.main-layout#philosophy
    include ../partials/main-nav-cities.jade
    include ../partials/main-nav-socials.jade
    include ../partials/main-nav-toggle.jade
    include ../partials/register-link.jade
    .circle-layout
      .circle.circle--1
      .circle.circle--2
      .circle.circle--3
    div.scroll-layout
      include ../partials/philosophy/philosophy-intro.jade
      include ../partials/philosophy/philosophy-about-1.jade
      include ../partials/philosophy/philosophy-about-2.jade
      include ../partials/philosophy/philosophy-about-3.jade
      include ../partials/philosophy/philosophy-inspiration.jade
      include ../partials/philosophy/philosophy-pros-1.jade
      include ../partials/philosophy/philosophy-pros-2.jade
      include ../partials/philosophy/philosophy-video.jade
      include ../partials/philosophy/philosophy-action.jade
      include ../partials/footer.jade

  script.
    $(function () {
      fixedMenusInitAnimation();

      // hide fixed menus on mobile
      $(window).on('resize', function () {
        var window = $(this);
        if (window.width() < 640) {
          TweenMax.to($('.main-layout > .main-nav--cities'), 1, {opacity: 0, ease: Power1.easeOut});
          TweenMax.to($('.main-layout > .register-link'), 1, {opacity: 0, ease: Power1.easeOut});
          TweenMax.to($('.main-layout > .main-nav--socials'), 1, {opacity: 0, ease: Power1.easeOut});
        } else {
          if ($('.onepage-pagination li .active').data('index') == 1) {
            TweenMax.to($('.main-layout > .main-nav--cities'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
            TweenMax.to($('.main-layout > .register-link'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
          }
        }
      });

      // init animations on mobile
      if ($(window).width() < 640) {

      }

      // Onepage scroll init
      var pageScroll = ".scroll-layout";
      $(pageScroll).onepage_scroll({
        sectionContainer: "section",
        easing: "ease",
        animationTime: 1200,
        pagination: true,
        updateURL: false,
        beforeMove: function (index) {
          if (index == 10) {
            fixedMenusHideAnimation();
          } else {
            fixedMenusReinit();
          }
          hidePagePagination();

          if (index == 1) {
            philosophyIntroInit();
          } else if (index == 2) {
            philosophyIntroHide();
          } else if (index == 3) {
            philosophyIntroHide();
          } else if (index == 4) {
            philosophyIntroHide();
          } else if (index == 5) {
            philosophyIntroHide();
          } else if (index == 6) {
            philosophyIntroHide();
          } else if (index == 7) {
            philosophyIntroHide();
          } else if (index == 8) {
            philosophyIntroHide();
          } else if (index == 9) {
            philosophyIntroHide();
          } else if (index == 10) {
            philosophyIntroHide();
          }
        },
        afterMove: function(index) {

        },
        loop: false,
        keyboard: true,
        responsiveFallback: 640,
        direction: "vertical"
      });

      // start intro animation on page load
      setTimeout(function () {
        if ($('.onepage-pagination li .active').data('index') == 1) {
          philosophyIntroInit();
        }
      }, 100);
    });

    var philosophyIntroReinit = true;

    function philosophyIntroInit() {

      TweenMax.to($('.scroll-down'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
      if ($(window).width() >= 640) {
        TweenMax.to($('.main-layout > .main-nav--socials'), 1, {opacity: 1, ease: Power1.easeOut, delay: 0.7});
      }
      TweenMax.to($('.circle--3'), 0.7, {opacity: 1, ease: Power4.easeOut});
      TweenMax.to($('.circle--2'), 0.7, {
        opacity: 1,
        top: '9.5%',
        left: '9.5%',
        width: '81%',
        height: '81%',
        ease: Power4.easeOut,
        delay: 0.5
      });
      TweenMax.to($('.circle--1'), 0.7, {
        opacity: 1,
        top: 0,
        left: 0,
        width: '100%',
        height: '100%',
        ease: Power4.easeOut,
        delay: 1
      });

      philosophyIntroReinit = false;
    }

    function philosophyIntroHide() {
      if (!philosophyIntroReinit) {
        TweenMax.to($('.main-layout > .main-nav--socials'), 1, {opacity: 0, ease: Power4.easeOut});
        TweenMax.to($('.scroll-down'), 1, {opacity: 0, ease: Power4.easeOut});

        TweenMax.to($('.circle--3'), 0.7, {opacity: 0, ease: Power4.easeOut});
        TweenMax.to($('.circle--2'), 0.7, {
          opacity: 0,
          top: '19%',
          left: '19%',
          width: '62%',
          height: '62%',
          ease: Power4.easeOut,
          delay: 0.1
        });
        TweenMax.to($('.circle--1'), 0.7, {
          opacity: 0,
          top: '9.5%',
          left: '9.5%',
          width: '81%',
          height: '81%',
          ease: Power4.easeOut,
          delay: 0.2
        });

        philosophyIntroReinit = true;
      }
    }

